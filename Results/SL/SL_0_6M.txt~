ubuntu@dm:~$ sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv 9DA31620334BD75D9DCB49F368818C72E52529D4
Executing: /tmp/tmp.mVbLmKRf61/gpg.1.sh --keyserver
hkp://keyserver.ubuntu.com:80
--recv
9DA31620334BD75D9DCB49F368818C72E52529D4
gpg: requesting key E52529D4 from hkp server keyserver.ubuntu.com
gpg: key E52529D4: "MongoDB 4.0 Release Signing Key <packaging@mongodb.com>" not changed
gpg: Total number processed: 1
gpg:              unchanged: 1
ubuntu@dm:~$ 
ubuntu@dm:~$ echo "deb [ arch=amd64,arm64 ] https://repo.mongodb.org/apt/ubuntu xenial/mongodb-org/4.0 multiverse" | sudo tee /etc/apt/sources.list.d/mongodb-org-4.0.list
deb [ arch=amd64,arm64 ] https://repo.mongodb.org/apt/ubuntu xenial/mongodb-org/4.0 multiverse
ubuntu@dm:~$ 
ubuntu@dm:~$ sudo apt-get install -y mongodb-org
Reading package lists... Done
Building dependency tree       
Reading state information... Done
The following additional packages will be installed:
  mongodb-org-mongos mongodb-org-server mongodb-org-shell mongodb-org-tools
The following NEW packages will be installed:
  mongodb-org mongodb-org-mongos mongodb-org-server mongodb-org-shell mongodb-org-tools
0 upgraded, 5 newly installed, 0 to remove and 4 not upgraded.
Need to get 0 B/58.6 MB of archives.
After this operation, 254 MB of additional disk space will be used.
Selecting previously unselected package mongodb-org-shell.
(Reading database ... 138555 files and directories currently installed.)
Preparing to unpack .../mongodb-org-shell_4.0.6_amd64.deb ...
Unpacking mongodb-org-shell (4.0.6) ...
Selecting previously unselected package mongodb-org-server.
Preparing to unpack .../mongodb-org-server_4.0.6_amd64.deb ...
Unpacking mongodb-org-server (4.0.6) ...
Selecting previously unselected package mongodb-org-mongos.
Preparing to unpack .../mongodb-org-mongos_4.0.6_amd64.deb ...
Unpacking mongodb-org-mongos (4.0.6) ...
Selecting previously unselected package mongodb-org-tools.
Preparing to unpack .../mongodb-org-tools_4.0.6_amd64.deb ...
Unpacking mongodb-org-tools (4.0.6) ...
Selecting previously unselected package mongodb-org.
Preparing to unpack .../mongodb-org_4.0.6_amd64.deb ...
Unpacking mongodb-org (4.0.6) ...
Processing triggers for man-db (2.7.5-1) ...
Setting up mongodb-org-shell (4.0.6) ...
Setting up mongodb-org-server (4.0.6) ...
Setting up mongodb-org-mongos (4.0.6) ...
Setting up mongodb-org-tools (4.0.6) ...
Setting up mongodb-org (4.0.6) ...
ubuntu@dm:~$ 
ubuntu@dm:~$ sudo service mongod start






ubuntu@dm:~$ mongoimport --db iswcSUBONEk --collection sub --drop --file ~/cpp_codes/ISWC/output/output_ref/out_onek_iswc_sub.json --jsonArray
2019-02-11T07:04:04.268+0000	connected to: localhost
2019-02-11T07:04:04.268+0000	dropping: iswcSUBONEk.sub
2019-02-11T07:04:07.267+0000	[###############.........] iswcSUBONEk.sub	30.4MB/47.4MB (64.1%)
2019-02-11T07:04:08.607+0000	[########################] iswcSUBONEk.sub	47.4MB/47.4MB (100.0%)
2019-02-11T07:04:08.607+0000	imported 62461 documents















ubuntu@dm:~$ mongo
MongoDB shell version v4.0.6
connecting to: mongodb://127.0.0.1:27017/?gssapiServiceName=mongodb
Implicit session: session { "id" : UUID("1c622b10-0de5-4eb0-80a3-bb713b676878") }
MongoDB server version: 4.0.6
Server has startup warnings: 
2019-02-11T07:01:37.441+0000 I STORAGE  [initandlisten] 
2019-02-11T07:01:37.441+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2019-02-11T07:01:37.441+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2019-02-11T07:01:38.678+0000 I CONTROL  [initandlisten] 
2019-02-11T07:01:38.678+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2019-02-11T07:01:38.678+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2019-02-11T07:01:38.678+0000 I CONTROL  [initandlisten] 
---
Enable MongoDB's free cloud-based monitoring service, which will then receive and display
metrics about your deployment (disk utilization, CPU, operation statistics, etc).

The monitoring data will be available on a MongoDB website with a unique URL accessible to you
and anyone you share the URL with. MongoDB may use this information to make product
improvements and to suggest MongoDB products and deployment options to you.

To enable free monitoring, run the following command: db.enableFreeMonitoring()
To permanently disable this reminder, run the following command: db.disableFreeMonitoring()
---
> show dbs
admin        0.000GB
config       0.000GB
iswcSUBONEk  0.031GB
local        0.000GB
> 

use iswcSUBONEk
db.setProfilingLevel(2)

######################################





ubuntu@dm:~$ sudo service mongod start
ubuntu@dm:~$ mongo
MongoDB shell version v4.0.6
connecting to: mongodb://127.0.0.1:27017/?gssapiServiceName=mongodb
Implicit session: session { "id" : UUID("97460ace-5db5-454f-a458-6b26adf283d3") }
MongoDB server version: 4.0.6
Server has startup warnings: 
2019-02-11T07:08:04.533+0000 I STORAGE  [initandlisten] 
2019-02-11T07:08:04.533+0000 I STORAGE  [initandlisten] ** WARNING: Using the XFS filesystem is strongly recommended with the WiredTiger storage engine
2019-02-11T07:08:04.533+0000 I STORAGE  [initandlisten] **          See http://dochub.mongodb.org/core/prodnotes-filesystem
2019-02-11T07:08:06.452+0000 I CONTROL  [initandlisten] 
2019-02-11T07:08:06.452+0000 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled for the database.
2019-02-11T07:08:06.452+0000 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.
2019-02-11T07:08:06.452+0000 I CONTROL  [initandlisten] 
---
Enable MongoDB's free cloud-based monitoring service, which will then receive and display
metrics about your deployment (disk utilization, CPU, operation statistics, etc).

The monitoring data will be available on a MongoDB website with a unique URL accessible to you
and anyone you share the URL with. MongoDB may use this information to make product
improvements and to suggest MongoDB products and deployment options to you.

To enable free monitoring, run the following command: db.enableFreeMonitoring()
To permanently disable this reminder, run the following command: db.disableFreeMonitoring()
---

> use iswcSUBONEk
switched to db iswcSUBONEk
> db.setProfilingLevel(2)
{ "was" : 0, "slowms" : 100, "sampleRate" : 1, "ok" : 1 }
> 
> 
> db.sub.aggregate([{$match:{_id:/Product/,Objects:{$all:["ProductFeature14","ProductFeature10","ProductType64"]}, $comment:"ISWC_SUB_ONEMil_Query1"  }},{$project:{Objects:"$Objects", num1: {  "$arrayElemAt": ["$Objects", {"$indexOfArray": ["$Predicates", "productPropertyNumeric1"]} ]  }    ,label: {  "$arrayElemAt": ["$Objects", {"$indexOfArray": ["$Predicates", "label"]} ]  }  }}, {$match:{num1:{$gt:1}}},{$sort:{label:1}},{$limit:10}],{allowDiskUse: true})
{ "_id" : "Product83", "Objects" : [ ISODate("2001-12-23T00:00:00Z"), "Producer2", "ProductFeature21", "ProductFeature20", "ProductFeature17", "ProductFeature14", "ProductFeature10", "ProductFeature5", "ProductFeature4", "ProductFeature1", "ProductFeature279", "ProductFeature278", "ProductFeature276", "ProductFeature269", "ProductFeature260", "ProductFeature258", "ProductFeature257", "ProductFeature254", "ProductFeature251", "ProductFeature250", "ProductFeature246", "ProductFeature243", "puckers chaplaincies snowbelt whoremaster", "lionized flume steatopygia managerially rehydrating hibiscuses asymptotical nimbler jolts promoter rachets laryngotracheal", "retched cartoning gambling concepts", "resellers disemboweled ripsaw eyeliners ashtrays jigger bushes logicize", "emblazons unsanitary grigs culotte dismals tritone operative compacts kohl finickiest redistills inappreciably accordantly", 1324, 36, 433, 127, 76, "Producer2", "ProductType64", "dwarfisms presumers scandalizes dedicators reties inhibiting insanely mecums irreducibilities cyanosis intendment ninnies wedder complaints glassiest outlaw xiii zippier aspidistras sepulcher elementals nonconvergent chorales sallies facials meadowlark identifies overcompetitive crests widower experimental oozed scatterbrains mineralogic enfettered phylae lr ostracods smolders stinginess rethread nonliturgical coll highhandedly autopilot oakums toked tenths commercialization rheumier congratulations toneless shirring uncritically plighting disfranchises sonatine braininess starving dabbed grabbiest buoyancy puerilities scepters nanoseconds infinitely bast decipherable savorily banqueter knots purgers bumbled concertizing fatales veneerer differentiating shoptalks moonfish estuaries ticketing abbreviating pastes sensitizes louisianians summarizes commandeers hatmakers wades applauded accoutres imitator sharecropping palinodes transhipment reveled purities siccing cockiness wording nutritiously serenely inactions farmable glassily presentability severing swerved foretell worthing defeminized quislings unslaked wethers spurreys fluted evacuated unconscionable affecters lallygags segregative dampeners wobbliness deceasing rapist visualizing bandits repudiation dissidents heartache scissors baobab rejuvenescent scantily lavishest", "fifing extraterritorial reckoned", "Product" ], "num1" : 76, "label" : "fifing extraterritorial reckoned" }
{ "_id" : "Product1777", "Objects" : [ ISODate("2002-01-11T00:00:00Z"), "Producer39", "ProductFeature18", "ProductFeature17", "ProductFeature14", "ProductFeature12", "ProductFeature11", "ProductFeature10", "ProductFeature5", "ProductFeature1", "ProductFeature278", "ProductFeature276", "ProductFeature275", "ProductFeature274", "ProductFeature259", "ProductFeature258", "ProductFeature246", "ProductFeature245", "ProductFeature243", "ProductFeature242", "ProductFeature240", "ProductFeature1918", "ProductFeature1910", "predeceases gumboils serologic bubbies immorality blameable degrades", "wisely delegacies nonexistent alar cloudlets foreside ponied seabeaches grandaunt nosy concessive brainwashes dungeons", "indefinably fantasts frettier pilgrims", 7, 492, 142, 790, "Producer39", "ProductType64", "paupering dalliances wallabies aeronauts campo abscises tiredness seventeens smoothy splendors mudrocks spattered assimilates limeys trivalves dissertations tanagers kettles urethral birdieing trawleys encoding grooming schoolteaching clothiers orbed affraying trumped tertian tremblingly lassoer undermined bonzes jurists anglicism campiest sinuates sheafs gamba oystered bellowers fulfills pontius reductions lifer actuating pollees raunchy sobbers rutting nonabrasiveness pulpily officiation roleplaying spirits inconsolably wheys boorishness tangos cicadae cirrostratus quencher trampler producers quadruplicates stairwells reenjoy bouldery unsuspecting chariots execrations corrupted charger lampoonist annuities pressoreceptor bettered attraction faintish apium crushing plumpens twosomes polled evokers underpay functionally terming", "replanted swooper noncontradictory", "Product" ], "num1" : 790, "label" : "replanted swooper noncontradictory" }
> 
> 
> db.sub.find({_id:"Product123"}).comment("ISWC_SUB_ONEMil_Query2")
{ "_id" : "Product123", "Predicates" : [ "date", "publisher", "productFeature", "productFeature", "productFeature", "productFeature", "productFeature", "productFeature", "productFeature", "productFeature", "productFeature", "productFeature", "productFeature", "productFeature", "productFeature", "productFeature", "productFeature", "productFeature", "productFeature", "productFeature", "productPropertyTextual5", "productPropertyTextual4", "productPropertyTextual3", "productPropertyTextual2", "productPropertyTextual1", "productPropertyNumeric5", "productPropertyNumeric4", "productPropertyNumeric3", "productPropertyNumeric2", "productPropertyNumeric1", "producer", "type", "comment", "label", "type" ], "Objects" : [ ISODate("2006-04-06T00:00:00Z"), "Producer3", "ProductFeature49", "ProductFeature47", "ProductFeature46", "ProductFeature44", "ProductFeature43", "ProductFeature42", "ProductFeature603", "ProductFeature600", "ProductFeature598", "ProductFeature593", "ProductFeature591", "ProductFeature2825", "ProductFeature2823", "ProductFeature2820", "ProductFeature2813", "ProductFeature2805", "ProductFeature2798", "ProductFeature2792", "recessional spectrographic hackly playgirl outgunning caches roentgenometries chronically chapmen oppositeness broads traipsing", "blunderer nationless masonwork jingled grandly iced messing pleasures", "englishwoman cartop undercharged councilors subscription violator nonobedience kabala feudists unwanted hockers brashier", "airest graduations tusks removals prises masculinizing wreaths doorless benumbedness", "choleras samoans muddiness forzando mechanisms sillers peerages inbreathe pummelling mudding countless prowesses plasher constructed", 1027, 10, 1527, 1558, 983, "Producer3", "ProductType91", "annullable preachiest solfeggi disseminates chequering sucker moderates explanations junketers anticommunism snickery pct burgundies collecting reappointment comities snoutiest entrenching heedlessly bumboat compactest iodizes pushups hypothesi ovulations supersensitive shoaliest aggregations perfidiously bridled recorders whispering gallons wedgier clearness unsalted hazed fangs oilily joineries wolfram pinon miniseries calcifying usufructs attaints diverticulitis superscripts boches gloved ambler incubative longness nursling forsaker curiums ratsbanes chubbily nondemocratic dissonance evils amaranthine sororities caveated breastbones foreran stamping dicotyledons riposting recheck paters successors loudlier deliberately proselytizer disfrocks shunter phoneticians investible tindery wedder lignifying proser glazing wordings grievers boxcars azimuths misdoers coalesces cageyness alloys ruins holystones signable timpani silkiness recompensive reverting wawls scintillatingly sestines burred aerily boleros footlights altruistic roughages acrostics burgomaster stoked wiretapped antineutrons austerity elitisms footway rehardened sweetens decomposing predictiveness nixing enthronements approachers loiterers uncoupled goop overdrew socialism protestable tentmaker protruding exposited dismay loper centripetally suspicions fitness misemploys cherishers repaving puckering cropper abortional gangrel", "reelers circulars overhanging", "Product" ] }
> 
> 
> 
> 
> 
> db.sub.aggregate([{$match:{_id:/Product/,Objects:{$all:["ProductFeature48","ProductType91"], $nin:["ProductFeature51"] }, $comment:"ISWC_SUB_ONEMil_Query3" }},{$project:{Objects:"$Objects", num1: {  "$arrayElemAt": ["$Objects", {"$indexOfArray": ["$Predicates", "productPropertyNumeric1"]} ]  } , num3: {  "$arrayElemAt": ["$Objects", {"$indexOfArray": ["$Predicates", "productPropertyNumeric3"]} ]  }   ,label: {  "$arrayElemAt": ["$Objects", {"$indexOfArray": ["$Predicates", "label"]} ]  }  }}, {$match:{   num1:{$gt:25}, num3:{$lt:250}  }},{$sort:{label:1}},{$limit:10}],{allowDiskUse: true})
{ "_id" : "Product940", "Objects" : [ ISODate("2003-02-09T00:00:00Z"), "Producer20", "ProductFeature48", "ProductFeature45", "ProductFeature44", "ProductFeature42", "ProductFeature40", "ProductFeature608", "ProductFeature605", "ProductFeature604", "ProductFeature602", "ProductFeature601", "ProductFeature600", "ProductFeature599", "ProductFeature595", "ProductFeature2824", "ProductFeature2821", "ProductFeature2818", "ProductFeature2817", "ProductFeature2811", "ProductFeature2797", "ProductFeature2796", "ProductFeature2794", "ProductFeature2790", "ProductFeature2789", "shiers decentest tambura shrubbier outplays valval", "appertaining radicalizes steadiers syzygal testacies adulation tats attainting pietist", "bereavements altering toolbox hurter septime seeder imparting snoopiest stargazers ciliata antimonarchists marveled unhats holily dabs", "advertent articulated irater physiological noncollapsable drawings evangelizes rebroadened stenciling impatiently modeled pilgrimages knockouts defoliators", "anatomically rechristens decompressed dupes annulment supersaturated exchequers", 404, 83, 198, 228, 449, "Producer20", "ProductType91", "programmes breasting braizes parleying zoroastrianism sculptured stilettoes announcers phoniest oubliette influencing assizer dutifully wantage sectary yielding freckliest studhorses preoccupations trainsickness gorgets quacked sarapes pailful measuring appendages provides domiciling hosannas undistinguishable ascertains impresses senescent heists sprawliest leaguer vitrified drownds lifeline mewls substantialness swanked newspaperwoman resister showplaces overfurnishes faiences pressured aureus ladanum berried shallowing staged chattily subphylum primitiveness ablations malignancies martlets loth preaccepting cancelable misadministration nonfiction fatefully mustached bethinks bro recencies rescinds coopery daiquiri benefitted perinea incomprehensiblies pampean pachisi reloaded shucker seabird rubicundity palpate tombing dadoing cleared twangiest pinks lured pawers widdling chemoreception selectively codex ogling overlay metricizes foggily pasting mannered sweats coupons evangelized televiewer wester uncharitably refried resales", "conflicts rushee", "Product" ], "num1" : 449, "num3" : 198, "label" : "conflicts rushee" }
> 
> 
> 
> 
> 
> 
> db.sub.aggregate([{$match:{ $and:[{_id:/Product/},{Objects:{$in:["ProductType91"]}}, {Objects:{$in:["ProductFeature51"]}},  {$or:[{Objects:{$in:["ProductFeature48"]}},{Objects:{$in:["ProductFeature45"]}}]}], $comment:"ISWC_SUB_ONEMil_Query4"}},{$project:{Objects:1, num1: {  "$arrayElemAt": ["$Objects", {"$indexOfArray": ["$Predicates", "productPropertyNumeric1"]} ]  } , num2: {  "$arrayElemAt": ["$Objects", {"$indexOfArray": ["$Predicates", "productPropertyNumeric2"]} ]  }   ,label: {  "$arrayElemAt": ["$Objects", {"$indexOfArray": ["$Predicates", "label"]} ]  }  }}, {$project:{Objects:1,num1:1,num2:1,label:1 , f1:{$cond:{if:{$and:[ {$in:["ProductFeature48","$Objects" ] }, {$gt:['$num1',20]} ] },then:1,else:0 } }   }},{$project:{Objects:1,num1:1,num2:1,label:1 ,f2:{$cond:{if:{ $and:[ {$in:["ProductFeature45","$Objects" ] }, {$gt:['$num2',25]} ] },then:1,else:0 } } ,f1:1  }}, {$match:{$or: [{f1:1},{f2:1}] }},{$sort:{label:1}}, {$limit:10},{ $skip : 10 } ],{allowDiskUse: true})
> 
> 
> 
> 
> 
> var ProductXYZ = db.sub.aggregate([{$match: {_id:"Product17", $comment:"ORIGINAL_ISWC_SUB_ONEMil_Query5_PArt1" } },{$project:{Predicates:"$Predicates", rPredicates:{$reverseArray: "$Predicates"}, Objects:"$Objects", rObjects:{$reverseArray: "$Objects"}  }},{$project:{ productFeatures: {$slice: ["$Objects", {"$indexOfArray": ["$Predicates", "productFeature"]  },{$abs:{$subtract:[   {"$indexOfArray": ["$rPredicates", "productFeature"]}   ,     {"$indexOfArray": ["$Predicates", "productFeature"]}]}}]} ,productPropertyNumeric1: {"$arrayElemAt": ["$Objects", {"$indexOfArray": ["$Predicates", "productPropertyNumeric1"]}]} ,productPropertyNumeric2: {"$arrayElemAt": ["$Objects", {"$indexOfArray": ["$Predicates", "productPropertyNumeric2"]}]}     }}  ],{allowDiskUse: true}).toArray()
> 
> 
> 
> 
> 
> 
> db.sub.aggregate([{$match:{_id:/^Product/ , Objects:{$all:ProductXYZ[0].productFeatures}, $comment:"ISWC_SUB_ONEMil_Query5_PArt2"}},{$project:{Objects:"$Objects", num1: {  "$arrayElemAt": ["$Objects", {"$indexOfArray": ["$Predicates", "productPropertyNumeric1"]} ]  } , num2: {  "$arrayElemAt": ["$Objects", {"$indexOfArray": ["$Predicates", "productPropertyNumeric2"]} ]  }   ,label: {  "$arrayElemAt": ["$Objects", {"$indexOfArray": ["$Predicates", "label"]} ]  }  }},{$project:{label:"$label", cond1: {$and:[ {$lt:["$num1",    (ProductXYZ[0].productPropertyNumeric1 + 170 )    ] }, {$gt: ["$num1",(ProductXYZ[0].productPropertyNumeric1 - 120 )] } ]} , cond2: {$and:[ {$lt:["$num2",    (ProductXYZ[0].productPropertyNumeric2 + 170 )    ] }, {$gt: ["$num2",(ProductXYZ[0].productPropertyNumeric1 - 170 )] } ]}}},{$match:{cond1:true,cond2:true } },{$project:{cond1:0,cond2:0}},{$sort:{label:1}},{$limit:5}],{allowDiskUse: true})
> 
> 
> 
> 
> 
> 
> 
> 
> db.sub.aggregate([ {$match:{_id:/^Product/ , $comment:"ORIGINAL_ISWC_SUB_ONEMil_Query6" }} , {$project:{label: {"$arrayElemAt": ["$Objects", {"$indexOfArray": ["$Predicates", "label"]}]}}} , {$match:{ label: {$regex: /is/} }} ],{allowDiskUse: true})
{ "_id" : "Product1001", "label" : "cambia commissariats" }
{ "_id" : "Product1005", "label" : "supremacist arbours" }
{ "_id" : "Product1007", "label" : "mixer finis monadism" }
{ "_id" : "Product1016", "label" : "prostatitis exec" }
{ "_id" : "Product1017", "label" : "radioisotope diestocks apparently" }
{ "_id" : "Product1025", "label" : "abolitionism" }
{ "_id" : "Product1032", "label" : "revisions" }
{ "_id" : "Product1036", "label" : "miaows sweetbriers preexists" }
{ "_id" : "Product1038", "label" : "vised spieler" }
{ "_id" : "Product1043", "label" : "frisbees preappointed ionization" }
{ "_id" : "Product1050", "label" : "unsatisfied casteism" }
{ "_id" : "Product1065", "label" : "commandoes vocalists surrenders" }
{ "_id" : "Product1070", "label" : "dovish aubades" }
{ "_id" : "Product1082", "label" : "gentiles puissantly" }
{ "_id" : "Product110", "label" : "jingoism" }
{ "_id" : "Product1100", "label" : "ascots mismatch" }
{ "_id" : "Product1109", "label" : "aqueously superiors faddist" }
{ "_id" : "Product111", "label" : "befouled fishponds rays" }
{ "_id" : "Product1111", "label" : "rediscovers" }
{ "_id" : "Product1119", "label" : "ghostwrites distinction survivability" }
Type "it" for more
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> var vendor_country = db.sub.aggregate([{$match:{ _id:/^Vendor/ , $comment:"ORIGINAL_ISWC_SUB_ONEMil_Query7_PArt1"  }},{$project: { country : {"$arrayElemAt": ["$Objects", {"$indexOfArray": ["$Predicates", "country"]}]}}},{$match:{country:"US"}},{$project:{country:0 }}    ],{allowDiskUse: true}).map(function(x){return x._id})
> 
> 
> 
> db.sub.aggregate([ {$match:{$or: [{_id:/^Offer/},{_id:/^Review/},{_id:"Product1"}] , $comment:"ISWC_SUB_ONEMil_Query7_PArt2" } } , {$project:{label : {"$arrayElemAt": ["$Objects", {"$indexOfArray": ["$Predicates", "label"]}]} , reviewFor: {"$arrayElemAt": ["$Objects", {"$indexOfArray": ["$Predicates", "reviewFor"]}]}  ,                    product: {"$arrayElemAt": ["$Objects", {"$indexOfArray": ["$Predicates", "product"]}]} , vendor : {"$arrayElemAt": ["$Objects", {"$indexOfArray": ["$Predicates", "vendor"]}]} , date : {"$arrayElemAt": ["$Objects", {"$indexOfArray": ["$Predicates", "date"]}]} , price : {"$arrayElemAt": ["$Objects", {"$indexOfArray": ["$Predicates", "price"]}]} , eq: {$cond:[{$gt: [  {"$arrayElemAt": ["$Objects", {"$indexOfArray": ["$Predicates", "date"]}]}  ,ISODate("2000-10-01")]},1,0 ] }  }  } , {$match:{$or: [ {reviewFor:"Product1"} ,{_id:"Product1"} ,{$and:[ {product:"Product1"} , {vendor :{$in:vendor_country }} ,{eq:1}]}]  }   } ],{allowDiskUse: true})
{ "_id" : "Offer3847", "label" : "Offer", "reviewFor" : "Offer", "product" : "Product1", "vendor" : "Vendor2", "date" : ISODate("2008-05-23T00:00:00Z"), "price" : 6198.7, "eq" : 1 }
{ "_id" : "Product1", "label" : "totally annat", "reviewFor" : "Product", "product" : "Product", "vendor" : "Product", "date" : ISODate("2000-11-01T00:00:00Z"), "price" : "Product", "eq" : 1 }
{ "_id" : "Review15336", "label" : "Review", "reviewFor" : "Product1", "product" : "Review", "vendor" : "Review", "date" : ISODate("2008-06-10T00:00:00Z"), "price" : "Review", "eq" : 1 }
{ "_id" : "Review17768", "label" : "Review", "reviewFor" : "Product1", "product" : "Review", "vendor" : "Review", "date" : ISODate("2008-06-13T00:00:00Z"), "price" : "Review", "eq" : 1 }
{ "_id" : "Review1817", "label" : "Review", "reviewFor" : "Product1", "product" : "Review", "vendor" : "Review", "date" : ISODate("2008-06-18T00:00:00Z"), "price" : "Review", "eq" : 1 }
{ "_id" : "Review7308", "label" : "Review", "reviewFor" : "Product1", "product" : "Review", "vendor" : "Review", "date" : ISODate("2008-05-12T00:00:00Z"), "price" : "Review", "eq" : 1 }
{ "_id" : "Review7783", "label" : "Review", "reviewFor" : "Product1", "product" : "Review", "vendor" : "Review", "date" : ISODate("2008-06-02T00:00:00Z"), "price" : "Review", "eq" : 1 }
> 
> 
> 
> 
> var ProductXYZ     = db.sub.find({_id:"Product1"}).comment("ISWC_SUB_ONEMil_Query7_PArt1").toArray() 
> 
> 
> db.sub.aggregate([{$match:  {_id:/^Review/, $comment:"ISWC_SUB_ONEMil_Query8_PArt2"}  },{$project:{language: {"$arrayElemAt": ["$Objects", {"$indexOfArray": ["$Predicates", "language"]}]} ,   title: {"$arrayElemAt": ["$Objects", {"$indexOfArray": ["$Predicates", "title"]}]}  ,    text: {"$arrayElemAt": ["$Objects", {"$indexOfArray": ["$Predicates", "text"]}]}, reviewDate: {"$arrayElemAt": ["$Objects", {"$indexOfArray": ["$Predicates", "date"]}]} , reviewer: {"$arrayElemAt": ["$Objects", {"$indexOfArray": ["$Predicates", "reviewer"]}]} ,  reviewFor: {"$arrayElemAt": ["$Objects", {"$indexOfArray": ["$Predicates", "reviewFor"]}]} }},{$match:{reviewFor:"Product1",language:"zh"}},{$lookup:{from:"sub", localField:"reviewer", foreignField:"_id", as:"reviewer"  }},{$sort:{reviewDate:-1}},{$limit:20} ],{allowDiskUse: true})
> 
> 
> 
> 
> 
> 
> 
> 
>  db.sub.aggregate([{$match:{_id:/^Review/, $comment:"ISWC_SUB_ONEMil_Query9"}},{$project:{  date: {"$arrayElemAt": ["$Objects", {"$indexOfArray": ["$Predicates", "date"]}]} ,  reviewFor: {"$arrayElemAt": ["$Objects", {"$indexOfArray": ["$Predicates", "reviewFor"]}]}  ,   title: {"$arrayElemAt": ["$Objects", {"$indexOfArray": ["$Predicates", "title"]}]}  ,  reviewer: {"$arrayElemAt": ["$Objects", {"$indexOfArray": ["$Predicates", "reviewer"]}]} }},{$lookup:{from:"sub", localField:"reviewer", foreignField:"_id", as:"reviewer"  }} ,{$group:{ _id:"$reviewer",Reviews:{$push:{_id:"$_id",title:"$title",product:"$reviewFor",date:"$date"  }} } },{$match:{'_id._id':"Reviewer1089"  }} ],{allowDiskUse: true})
> 
> 
> 
> 
> 
> db.sub.aggregate([{$match:{ _id:/^Offer/ , $comment:"ISWC_SUB_ONEMil_Query10"}},{$project:{deliveryDays: {"$arrayElemAt": ["$Objects", {"$indexOfArray": ["$Predicates", "deliveryDays"]}]}   ,  vendor: {"$arrayElemAt": ["$Objects", {"$indexOfArray": ["$Predicates", "vendor"]}]}   ,date: {"$arrayElemAt": ["$Objects", {"$indexOfArray": ["$Predicates", "date"]}]}, product: {"$arrayElemAt": ["$Objects", {"$indexOfArray": ["$Predicates", "product"]}]}   ,   price: {"$arrayElemAt": ["$Objects", {"$indexOfArray": ["$Predicates", "price"]}]}           } },{$match:{ deliveryDays:{$lte:4},product:"Product1"  ,date:{$gt:new Date("2005-04-03T00:00:00Z")}   }} ,{$lookup:{from:"sub", localField:"vendor",foreignField:"_id", as:"vendor"  }},{$match:{'vendor.Objects':"US"}},{$sort:{price:1}},{$limit:10}  ],{allowDiskUse: true})
{ "_id" : "Offer3847", "deliveryDays" : 3, "vendor" : [ { "_id" : "Vendor2", "Predicates" : [ "date", "publisher", "country", "homepage", "comment", "label", "type" ], "Objects" : [ ISODate("2008-06-18T00:00:00Z"), "Vendor2", "US", "http://www.vendor2.com", "comforts gazetting napless venation hamsters portraying commonalties readd engilding sidestroke intertwines boasts casing naughtily repealable pollees antidisestablishmentarianism misreading triskaidekaphobia fierily signoras grogshop", "protracting", "Vendor" ] } ], "date" : ISODate("2008-05-23T00:00:00Z"), "product" : "Product1", "price" : 6198.7 }
> 
> 
> 
> 
> db.sub.aggregate([{$match:{_id:"Offer1", $comment:"ISWC_SUB_ONEMil_Query11"}},{$project:{Predicates:"$Predicates",Objects:"$Objects", product: {"$arrayElemAt": ["$Objects", {"$indexOfArray": ["$Predicates", "product"]}]} } },{$lookup:{from:"sub", localField:"product",foreignField:"_id", as:"product"  }}   ],{allowDiskUse: true})
{ "_id" : "Offer1", "Predicates" : [ "date", "publisher", "offerWebpage", "deliveryDays", "validTo", "validFrom", "price", "vendor", "product", "type" ], "Objects" : [ ISODate("2008-06-17T00:00:00Z"), "Vendor1", "Offer1", 5, ISODate("2008-09-11T00:00:00Z"), ISODate("2008-03-20T00:00:00Z"), 7683.53, "Vendor1", "Product1385", "Offer" ], "product" : [ { "_id" : "Product1385", "Predicates" : [ "date", "publisher", "productFeature", "productFeature", "productFeature", "productFeature", "productFeature", "productFeature", "productFeature", "productFeature", "productFeature", "productFeature", "productFeature", "productFeature", "productFeature", "productFeature", "productFeature", "productPropertyTextual6", "productPropertyTextual5", "productPropertyTextual3", "productPropertyTextual2", "productPropertyTextual1", "productPropertyNumeric6", "productPropertyNumeric5", "productPropertyNumeric3", "productPropertyNumeric2", "productPropertyNumeric1", "producer", "type", "comment", "label", "type" ], "Objects" : [ ISODate("2001-10-07T00:00:00Z"), "Producer31", "ProductFeature36", "ProductFeature30", "ProductFeature27", "ProductFeature26", "ProductFeature529", "ProductFeature518", "ProductFeature516", "ProductFeature2586", "ProductFeature2584", "ProductFeature2578", "ProductFeature2573", "ProductFeature2569", "ProductFeature2567", "ProductFeature2566", "ProductFeature2562", "pearlier pewterers bullfighter starry stinkards gavelling clogs comprized branched destructible overdeveloped unitizes", "digitalize brassies impenitent", "erythema winterkill travelable medalists webers muddiest dissembler", "sarcasms traitors macros admitters cherubic putrefying underclothes metamers retrench hadji packing immix cymes outfitting boxed", "outline unswerving decolonizes toolbox synagog humanizes armory delivering draggiest", 118, 246, 1667, 551, 882, "Producer31", "ProductType84", "disputations tweeter peatiest quibbling deathlessly tunneller bellying bries sumpter antineutrinos dockets cords nosed modulation galvanizations deadfall stows fulness truelove seconded mumbo accordance resembling sensibles trumpeter microgram veterans locking tritone mildewy wriggliest maritally engineering degenerations deviltry unperfected jukebox cyans forecasted remittent sadomasochists mistaker requisitioners beautifiers unserved insoles fluorinating gravitic aunts montanans iffier callusing autumns chandlers procuress leakiest gnotobiotics gawkier masher", "vouchee", "Product" ] } ] }
> 
> 
> 
> 



















###################################################################
Profile:



> db.system.profile.find().sort( { ts : 1 } ).pretty()
{
	"op" : "command",
	"ns" : "iswcSUBONEk.sub",
	"command" : {
		"aggregate" : "sub",
		"pipeline" : [
			{
				"$match" : {
					"_id" : /Product/,
					"Objects" : {
						"$all" : [
							"ProductFeature14",
							"ProductFeature10",
							"ProductType64"
						]
					},
					"$comment" : "ISWC_SUB_ONEMil_Query1"
				}
			},
			{
				"$project" : {
					"Objects" : "$Objects",
					"num1" : {
						"$arrayElemAt" : [
							"$Objects",
							{
								"$indexOfArray" : [
									"$Predicates",
									"productPropertyNumeric1"
								]
							}
						]
					},
					"label" : {
						"$arrayElemAt" : [
							"$Objects",
							{
								"$indexOfArray" : [
									"$Predicates",
									"label"
								]
							}
						]
					}
				}
			},
			{
				"$match" : {
					"num1" : {
						"$gt" : 1
					}
				}
			},
			{
				"$sort" : {
					"label" : 1
				}
			},
			{
				"$limit" : 10
			}
		],
		"allowDiskUse" : true,
		"cursor" : {
			
		},
		"lsid" : {
			"id" : UUID("97460ace-5db5-454f-a458-6b26adf283d3")
		},
		"$db" : "iswcSUBONEk"
	},
	"keysExamined" : 62461,
	"docsExamined" : 6721,
	"hasSortStage" : true,
	"cursorExhausted" : true,
	"numYield" : 492,
	"nreturned" : 2,
	"locks" : {
		"Global" : {
			"acquireCount" : {
				"r" : NumberLong(494)
			}
		},
		"Database" : {
			"acquireCount" : {
				"r" : NumberLong(494)
			}
		},
		"Collection" : {
			"acquireCount" : {
				"r" : NumberLong(494)
			}
		}
	},
	"responseLength" : 4545,
	"protocol" : "op_msg",
	"millis" : 378,
	"planSummary" : "IXSCAN { _id: 1 }",
	"ts" : ISODate("2019-02-11T07:09:30.001Z"),
	"client" : "127.0.0.1",
	"appName" : "MongoDB Shell",
	"allUsers" : [ ],
	"user" : ""
}
{
	"op" : "query",
	"ns" : "iswcSUBONEk.sub",
	"command" : {
		"find" : "sub",
		"filter" : {
			"_id" : "Product123"
		},
		"comment" : "ISWC_SUB_ONEMil_Query2",
		"lsid" : {
			"id" : UUID("97460ace-5db5-454f-a458-6b26adf283d3")
		},
		"$db" : "iswcSUBONEk"
	},
	"keysExamined" : 1,
	"docsExamined" : 1,
	"cursorExhausted" : true,
	"numYield" : 0,
	"nreturned" : 1,
	"locks" : {
		"Global" : {
			"acquireCount" : {
				"r" : NumberLong(1)
			}
		},
		"Database" : {
			"acquireCount" : {
				"r" : NumberLong(1)
			}
		},
		"Collection" : {
			"acquireCount" : {
				"r" : NumberLong(1)
			}
		}
	},
	"responseLength" : 3611,
	"protocol" : "op_msg",
	"millis" : 0,
	"planSummary" : "IDHACK",
	"execStats" : {
		"stage" : "IDHACK",
		"nReturned" : 1,
		"executionTimeMillisEstimate" : 0,
		"works" : 2,
		"advanced" : 1,
		"needTime" : 0,
		"needYield" : 0,
		"saveState" : 0,
		"restoreState" : 0,
		"isEOF" : 1,
		"invalidates" : 0,
		"keysExamined" : 1,
		"docsExamined" : 1
	},
	"ts" : ISODate("2019-02-11T07:09:35.554Z"),
	"client" : "127.0.0.1",
	"appName" : "MongoDB Shell",
	"allUsers" : [ ],
	"user" : ""
}
{
	"op" : "command",
	"ns" : "iswcSUBONEk.sub",
	"command" : {
		"aggregate" : "sub",
		"pipeline" : [
			{
				"$match" : {
					"_id" : /Product/,
					"Objects" : {
						"$all" : [
							"ProductFeature48",
							"ProductType91"
						],
						"$nin" : [
							"ProductFeature51"
						]
					},
					"$comment" : "ISWC_SUB_ONEMil_Query3"
				}
			},
			{
				"$project" : {
					"Objects" : "$Objects",
					"num1" : {
						"$arrayElemAt" : [
							"$Objects",
							{
								"$indexOfArray" : [
									"$Predicates",
									"productPropertyNumeric1"
								]
							}
						]
					},
					"num3" : {
						"$arrayElemAt" : [
							"$Objects",
							{
								"$indexOfArray" : [
									"$Predicates",
									"productPropertyNumeric3"
								]
							}
						]
					},
					"label" : {
						"$arrayElemAt" : [
							"$Objects",
							{
								"$indexOfArray" : [
									"$Predicates",
									"label"
								]
							}
						]
					}
				}
			},
			{
				"$match" : {
					"num1" : {
						"$gt" : 25
					},
					"num3" : {
						"$lt" : 250
					}
				}
			},
			{
				"$sort" : {
					"label" : 1
				}
			},
			{
				"$limit" : 10
			}
		],
		"allowDiskUse" : true,
		"cursor" : {
			
		},
		"lsid" : {
			"id" : UUID("97460ace-5db5-454f-a458-6b26adf283d3")
		},
		"$db" : "iswcSUBONEk"
	},
	"keysExamined" : 62461,
	"docsExamined" : 6721,
	"hasSortStage" : true,
	"cursorExhausted" : true,
	"numYield" : 487,
	"nreturned" : 1,
	"locks" : {
		"Global" : {
			"acquireCount" : {
				"r" : NumberLong(489)
			}
		},
		"Database" : {
			"acquireCount" : {
				"r" : NumberLong(489)
			}
		},
		"Collection" : {
			"acquireCount" : {
				"r" : NumberLong(489)
			}
		}
	},
	"responseLength" : 2543,
	"protocol" : "op_msg",
	"millis" : 125,
	"planSummary" : "IXSCAN { _id: 1 }",
	"ts" : ISODate("2019-02-11T07:09:43.140Z"),
	"client" : "127.0.0.1",
	"appName" : "MongoDB Shell",
	"allUsers" : [ ],
	"user" : ""
}
{
	"op" : "command",
	"ns" : "iswcSUBONEk.sub",
	"command" : {
		"aggregate" : "sub",
		"pipeline" : [
			{
				"$match" : {
					"$and" : [
						{
							"_id" : /Product/
						},
						{
							"Objects" : {
								"$in" : [
									"ProductType91"
								]
							}
						},
						{
							"Objects" : {
								"$in" : [
									"ProductFeature51"
								]
							}
						},
						{
							"$or" : [
								{
									"Objects" : {
										"$in" : [
											"ProductFeature48"
										]
									}
								},
								{
									"Objects" : {
										"$in" : [
											"ProductFeature45"
										]
									}
								}
							]
						}
					],
					"$comment" : "ISWC_SUB_ONEMil_Query4"
				}
			},
			{
				"$project" : {
					"Objects" : 1,
					"num1" : {
						"$arrayElemAt" : [
							"$Objects",
							{
								"$indexOfArray" : [
									"$Predicates",
									"productPropertyNumeric1"
								]
							}
						]
					},
					"num2" : {
						"$arrayElemAt" : [
							"$Objects",
							{
								"$indexOfArray" : [
									"$Predicates",
									"productPropertyNumeric2"
								]
							}
						]
					},
					"label" : {
						"$arrayElemAt" : [
							"$Objects",
							{
								"$indexOfArray" : [
									"$Predicates",
									"label"
								]
							}
						]
					}
				}
			},
			{
				"$project" : {
					"Objects" : 1,
					"num1" : 1,
					"num2" : 1,
					"label" : 1,
					"f1" : {
						"$cond" : {
							"if" : {
								"$and" : [
									{
										"$in" : [
											"ProductFeature48",
											"$Objects"
										]
									},
									{
										"$gt" : [
											"$num1",
											20
										]
									}
								]
							},
							"then" : 1,
							"else" : 0
						}
					}
				}
			},
			{
				"$project" : {
					"Objects" : 1,
					"num1" : 1,
					"num2" : 1,
					"label" : 1,
					"f2" : {
						"$cond" : {
							"if" : {
								"$and" : [
									{
										"$in" : [
											"ProductFeature45",
											"$Objects"
										]
									},
									{
										"$gt" : [
											"$num2",
											25
										]
									}
								]
							},
							"then" : 1,
							"else" : 0
						}
					},
					"f1" : 1
				}
			},
			{
				"$match" : {
					"$or" : [
						{
							"f1" : 1
						},
						{
							"f2" : 1
						}
					]
				}
			},
			{
				"$sort" : {
					"label" : 1
				}
			},
			{
				"$limit" : 10
			},
			{
				"$skip" : 10
			}
		],
		"allowDiskUse" : true,
		"cursor" : {
			
		},
		"lsid" : {
			"id" : UUID("97460ace-5db5-454f-a458-6b26adf283d3")
		},
		"$db" : "iswcSUBONEk"
	},
	"keysExamined" : 62461,
	"docsExamined" : 6721,
	"hasSortStage" : true,
	"cursorExhausted" : true,
	"numYield" : 487,
	"nreturned" : 0,
	"locks" : {
		"Global" : {
			"acquireCount" : {
				"r" : NumberLong(489)
			}
		},
		"Database" : {
			"acquireCount" : {
				"r" : NumberLong(489)
			}
		},
		"Collection" : {
			"acquireCount" : {
				"r" : NumberLong(489)
			}
		}
	},
	"responseLength" : 104,
	"protocol" : "op_msg",
	"millis" : 132,
	"planSummary" : "IXSCAN { _id: 1 }",
	"ts" : ISODate("2019-02-11T07:09:51.945Z"),
	"client" : "127.0.0.1",
	"appName" : "MongoDB Shell",
	"allUsers" : [ ],
	"user" : ""
}
{
	"op" : "command",
	"ns" : "iswcSUBONEk.sub",
	"command" : {
		"aggregate" : "sub",
		"pipeline" : [
			{
				"$match" : {
					"_id" : "Product17",
					"$comment" : "ORIGINAL_ISWC_SUB_ONEMil_Query5_PArt1"
				}
			},
			{
				"$project" : {
					"Predicates" : "$Predicates",
					"rPredicates" : {
						"$reverseArray" : "$Predicates"
					},
					"Objects" : "$Objects",
					"rObjects" : {
						"$reverseArray" : "$Objects"
					}
				}
			},
			{
				"$project" : {
					"productFeatures" : {
						"$slice" : [
							"$Objects",
							{
								"$indexOfArray" : [
									"$Predicates",
									"productFeature"
								]
							},
							{
								"$abs" : {
									"$subtract" : [
										{
											"$indexOfArray" : [
												"$rPredicates",
												"productFeature"
											]
										},
										{
											"$indexOfArray" : [
												"$Predicates",
												"productFeature"
											]
										}
									]
								}
							}
						]
					},
					"productPropertyNumeric1" : {
						"$arrayElemAt" : [
							"$Objects",
							{
								"$indexOfArray" : [
									"$Predicates",
									"productPropertyNumeric1"
								]
							}
						]
					},
					"productPropertyNumeric2" : {
						"$arrayElemAt" : [
							"$Objects",
							{
								"$indexOfArray" : [
									"$Predicates",
									"productPropertyNumeric2"
								]
							}
						]
					}
				}
			}
		],
		"allowDiskUse" : true,
		"cursor" : {
			
		},
		"lsid" : {
			"id" : UUID("97460ace-5db5-454f-a458-6b26adf283d3")
		},
		"$db" : "iswcSUBONEk"
	},
	"keysExamined" : 1,
	"docsExamined" : 1,
	"cursorExhausted" : true,
	"numYield" : 0,
	"nreturned" : 1,
	"locks" : {
		"Global" : {
			"acquireCount" : {
				"r" : NumberLong(2)
			}
		},
		"Database" : {
			"acquireCount" : {
				"r" : NumberLong(2)
			}
		},
		"Collection" : {
			"acquireCount" : {
				"r" : NumberLong(2)
			}
		}
	},
	"responseLength" : 549,
	"protocol" : "op_msg",
	"millis" : 0,
	"planSummary" : "IXSCAN { _id: 1 }",
	"ts" : ISODate("2019-02-11T07:10:03.714Z"),
	"client" : "127.0.0.1",
	"appName" : "MongoDB Shell",
	"allUsers" : [ ],
	"user" : ""
}
{
	"op" : "command",
	"ns" : "iswcSUBONEk.sub",
	"command" : {
		"aggregate" : "sub",
		"pipeline" : [
			{
				"$match" : {
					"_id" : /^Product/,
					"Objects" : {
						"$all" : [
							"ProductFeature109",
							"ProductFeature107",
							"ProductFeature102",
							"ProductFeature1606",
							"ProductFeature1605",
							"ProductFeature1604",
							"ProductFeature1595",
							"ProductFeature1594",
							"ProductFeature1580",
							"ProductFeature4670",
							"ProductFeature4669",
							"ProductFeature4652",
							"ProductFeature4640"
						]
					},
					"$comment" : "ISWC_SUB_ONEMil_Query5_PArt2"
				}
			},
			{
				"$project" : {
					"Objects" : "$Objects",
					"num1" : {
						"$arrayElemAt" : [
							"$Objects",
							{
								"$indexOfArray" : [
									"$Predicates",
									"productPropertyNumeric1"
								]
							}
						]
					},
					"num2" : {
						"$arrayElemAt" : [
							"$Objects",
							{
								"$indexOfArray" : [
									"$Predicates",
									"productPropertyNumeric2"
								]
							}
						]
					},
					"label" : {
						"$arrayElemAt" : [
							"$Objects",
							{
								"$indexOfArray" : [
									"$Predicates",
									"label"
								]
							}
						]
					}
				}
			},
			{
				"$project" : {
					"label" : "$label",
					"cond1" : {
						"$and" : [
							{
								"$lt" : [
									"$num1",
									1163
								]
							},
							{
								"$gt" : [
									"$num1",
									873
								]
							}
						]
					},
					"cond2" : {
						"$and" : [
							{
								"$lt" : [
									"$num2",
									582
								]
							},
							{
								"$gt" : [
									"$num2",
									823
								]
							}
						]
					}
				}
			},
			{
				"$match" : {
					"cond1" : true,
					"cond2" : true
				}
			},
			{
				"$project" : {
					"cond1" : 0,
					"cond2" : 0
				}
			},
			{
				"$sort" : {
					"label" : 1
				}
			},
			{
				"$limit" : 5
			}
		],
		"allowDiskUse" : true,
		"cursor" : {
			
		},
		"lsid" : {
			"id" : UUID("97460ace-5db5-454f-a458-6b26adf283d3")
		},
		"$db" : "iswcSUBONEk"
	},
	"keysExamined" : 6722,
	"docsExamined" : 6721,
	"hasSortStage" : true,
	"cursorExhausted" : true,
	"numYield" : 52,
	"nreturned" : 0,
	"locks" : {
		"Global" : {
			"acquireCount" : {
				"r" : NumberLong(54)
			}
		},
		"Database" : {
			"acquireCount" : {
				"r" : NumberLong(54)
			}
		},
		"Collection" : {
			"acquireCount" : {
				"r" : NumberLong(54)
			}
		}
	},
	"responseLength" : 104,
	"protocol" : "op_msg",
	"millis" : 38,
	"planSummary" : "IXSCAN { _id: 1 }",
	"ts" : ISODate("2019-02-11T07:10:03.788Z"),
	"client" : "127.0.0.1",
	"appName" : "MongoDB Shell",
	"allUsers" : [ ],
	"user" : ""
}
{
	"op" : "command",
	"ns" : "iswcSUBONEk.sub",
	"command" : {
		"aggregate" : "sub",
		"pipeline" : [
			{
				"$match" : {
					"_id" : /^Product/,
					"$comment" : "ORIGINAL_ISWC_SUB_ONEMil_Query6"
				}
			},
			{
				"$project" : {
					"label" : {
						"$arrayElemAt" : [
							"$Objects",
							{
								"$indexOfArray" : [
									"$Predicates",
									"label"
								]
							}
						]
					}
				}
			},
			{
				"$match" : {
					"label" : {
						"$regex" : /is/
					}
				}
			}
		],
		"allowDiskUse" : true,
		"cursor" : {
			
		},
		"lsid" : {
			"id" : UUID("97460ace-5db5-454f-a458-6b26adf283d3")
		},
		"$db" : "iswcSUBONEk"
	},
	"cursorid" : NumberLong("7787068143434709656"),
	"keysExamined" : 910,
	"docsExamined" : 910,
	"numYield" : 7,
	"nreturned" : 101,
	"locks" : {
		"Global" : {
			"acquireCount" : {
				"r" : NumberLong(9)
			}
		},
		"Database" : {
			"acquireCount" : {
				"r" : NumberLong(9)
			}
		},
		"Collection" : {
			"acquireCount" : {
				"r" : NumberLong(9)
			}
		}
	},
	"responseLength" : 6722,
	"protocol" : "op_msg",
	"millis" : 29,
	"planSummary" : "IXSCAN { _id: 1 }",
	"ts" : ISODate("2019-02-11T07:10:11.601Z"),
	"client" : "127.0.0.1",
	"appName" : "MongoDB Shell",
	"allUsers" : [ ],
	"user" : ""
}
{
	"op" : "command",
	"ns" : "iswcSUBONEk.sub",
	"command" : {
		"aggregate" : "sub",
		"pipeline" : [
			{
				"$match" : {
					"_id" : /^Vendor/,
					"$comment" : "ORIGINAL_ISWC_SUB_ONEMil_Query7_PArt1"
				}
			},
			{
				"$project" : {
					"country" : {
						"$arrayElemAt" : [
							"$Objects",
							{
								"$indexOfArray" : [
									"$Predicates",
									"country"
								]
							}
						]
					}
				}
			},
			{
				"$match" : {
					"country" : "US"
				}
			},
			{
				"$project" : {
					"country" : 0
				}
			}
		],
		"allowDiskUse" : true,
		"cursor" : {
			
		},
		"lsid" : {
			"id" : UUID("97460ace-5db5-454f-a458-6b26adf283d3")
		},
		"$db" : "iswcSUBONEk"
	},
	"keysExamined" : 21,
	"docsExamined" : 21,
	"cursorExhausted" : true,
	"numYield" : 3,
	"nreturned" : 7,
	"locks" : {
		"Global" : {
			"acquireCount" : {
				"r" : NumberLong(5)
			}
		},
		"Database" : {
			"acquireCount" : {
				"r" : NumberLong(5)
			}
		},
		"Collection" : {
			"acquireCount" : {
				"r" : NumberLong(5)
			}
		}
	},
	"responseLength" : 282,
	"protocol" : "op_msg",
	"millis" : 82,
	"planSummary" : "IXSCAN { _id: 1 }",
	"ts" : ISODate("2019-02-11T07:10:18.682Z"),
	"client" : "127.0.0.1",
	"appName" : "MongoDB Shell",
	"allUsers" : [ ],
	"user" : ""
}
{
	"op" : "command",
	"ns" : "iswcSUBONEk.sub",
	"command" : {
		"aggregate" : "sub",
		"pipeline" : [
			{
				"$match" : {
					"$or" : [
						{
							"_id" : /^Offer/
						},
						{
							"_id" : /^Review/
						},
						{
							"_id" : "Product1"
						}
					],
					"$comment" : "ISWC_SUB_ONEMil_Query7_PArt2"
				}
			},
			{
				"$project" : {
					"label" : {
						"$arrayElemAt" : [
							"$Objects",
							{
								"$indexOfArray" : [
									"$Predicates",
									"label"
								]
							}
						]
					},
					"reviewFor" : {
						"$arrayElemAt" : [
							"$Objects",
							{
								"$indexOfArray" : [
									"$Predicates",
									"reviewFor"
								]
							}
						]
					},
					"product" : {
						"$arrayElemAt" : [
							"$Objects",
							{
								"$indexOfArray" : [
									"$Predicates",
									"product"
								]
							}
						]
					},
					"vendor" : {
						"$arrayElemAt" : [
							"$Objects",
							{
								"$indexOfArray" : [
									"$Predicates",
									"vendor"
								]
							}
						]
					},
					"date" : {
						"$arrayElemAt" : [
							"$Objects",
							{
								"$indexOfArray" : [
									"$Predicates",
									"date"
								]
							}
						]
					},
					"price" : {
						"$arrayElemAt" : [
							"$Objects",
							{
								"$indexOfArray" : [
									"$Predicates",
									"price"
								]
							}
						]
					},
					"eq" : {
						"$cond" : [
							{
								"$gt" : [
									{
										"$arrayElemAt" : [
											"$Objects",
											{
												"$indexOfArray" : [
													"$Predicates",
													"date"
												]
											}
										]
									},
									ISODate("2000-10-01T00:00:00Z")
								]
							},
							1,
							0
						]
					}
				}
			},
			{
				"$match" : {
					"$or" : [
						{
							"reviewFor" : "Product1"
						},
						{
							"_id" : "Product1"
						},
						{
							"$and" : [
								{
									"product" : "Product1"
								},
								{
									"vendor" : {
										"$in" : [
											"Vendor12",
											"Vendor17",
											"Vendor2",
											"Vendor21",
											"Vendor4",
											"Vendor7",
											"Vendor9"
										]
									}
								},
								{
									"eq" : 1
								}
							]
						}
					]
				}
			}
		],
		"allowDiskUse" : true,
		"cursor" : {
			
		},
		"lsid" : {
			"id" : UUID("97460ace-5db5-454f-a458-6b26adf283d3")
		},
		"$db" : "iswcSUBONEk"
	},
	"keysExamined" : 55683,
	"docsExamined" : 55680,
	"cursorExhausted" : true,
	"numYield" : 442,
	"nreturned" : 7,
	"locks" : {
		"Global" : {
			"acquireCount" : {
				"r" : NumberLong(458)
			}
		},
		"Database" : {
			"acquireCount" : {
				"r" : NumberLong(458)
			}
		},
		"Collection" : {
			"acquireCount" : {
				"r" : NumberLong(458)
			}
		}
	},
	"responseLength" : 1179,
	"protocol" : "op_msg",
	"millis" : 1339,
	"planSummary" : "IXSCAN { _id: 1 }",
	"ts" : ISODate("2019-02-11T07:10:20.069Z"),
	"client" : "127.0.0.1",
	"appName" : "MongoDB Shell",
	"allUsers" : [ ],
	"user" : ""
}
{
	"op" : "query",
	"ns" : "iswcSUBONEk.sub",
	"command" : {
		"find" : "sub",
		"filter" : {
			"_id" : "Product1"
		},
		"comment" : "ISWC_SUB_ONEMil_Query8_PArt1",
		"lsid" : {
			"id" : UUID("97460ace-5db5-454f-a458-6b26adf283d3")
		},
		"$db" : "iswcSUBONEk"
	},
	"keysExamined" : 1,
	"docsExamined" : 1,
	"cursorExhausted" : true,
	"numYield" : 0,
	"nreturned" : 1,
	"locks" : {
		"Global" : {
			"acquireCount" : {
				"r" : NumberLong(1)
			}
		},
		"Database" : {
			"acquireCount" : {
				"r" : NumberLong(1)
			}
		},
		"Collection" : {
			"acquireCount" : {
				"r" : NumberLong(1)
			}
		}
	},
	"responseLength" : 2827,
	"protocol" : "op_msg",
	"millis" : 0,
	"planSummary" : "IDHACK",
	"execStats" : {
		"stage" : "IDHACK",
		"nReturned" : 1,
		"executionTimeMillisEstimate" : 0,
		"works" : 2,
		"advanced" : 1,
		"needTime" : 0,
		"needYield" : 0,
		"saveState" : 0,
		"restoreState" : 0,
		"isEOF" : 1,
		"invalidates" : 0,
		"keysExamined" : 1,
		"docsExamined" : 1
	},
	"ts" : ISODate("2019-02-11T07:10:31.604Z"),
	"client" : "127.0.0.1",
	"appName" : "MongoDB Shell",
	"allUsers" : [ ],
	"user" : ""
}
{
	"op" : "command",
	"ns" : "iswcSUBONEk.sub",
	"command" : {
		"aggregate" : "sub",
		"pipeline" : [
			{
				"$match" : {
					"_id" : /^Review/,
					"$comment" : "ISWC_SUB_ONEMil_Query8_PArt2"
				}
			},
			{
				"$project" : {
					"language" : {
						"$arrayElemAt" : [
							"$Objects",
							{
								"$indexOfArray" : [
									"$Predicates",
									"language"
								]
							}
						]
					},
					"title" : {
						"$arrayElemAt" : [
							"$Objects",
							{
								"$indexOfArray" : [
									"$Predicates",
									"title"
								]
							}
						]
					},
					"text" : {
						"$arrayElemAt" : [
							"$Objects",
							{
								"$indexOfArray" : [
									"$Predicates",
									"text"
								]
							}
						]
					},
					"reviewDate" : {
						"$arrayElemAt" : [
							"$Objects",
							{
								"$indexOfArray" : [
									"$Predicates",
									"date"
								]
							}
						]
					},
					"reviewer" : {
						"$arrayElemAt" : [
							"$Objects",
							{
								"$indexOfArray" : [
									"$Predicates",
									"reviewer"
								]
							}
						]
					},
					"reviewFor" : {
						"$arrayElemAt" : [
							"$Objects",
							{
								"$indexOfArray" : [
									"$Predicates",
									"reviewFor"
								]
							}
						]
					}
				}
			},
			{
				"$match" : {
					"reviewFor" : "Product1",
					"language" : "zh"
				}
			},
			{
				"$lookup" : {
					"from" : "sub",
					"localField" : "reviewer",
					"foreignField" : "_id",
					"as" : "reviewer"
				}
			},
			{
				"$sort" : {
					"reviewDate" : -1
				}
			},
			{
				"$limit" : 20
			}
		],
		"allowDiskUse" : true,
		"cursor" : {
			
		},
		"lsid" : {
			"id" : UUID("97460ace-5db5-454f-a458-6b26adf283d3")
		},
		"$db" : "iswcSUBONEk"
	},
	"keysExamined" : 19180,
	"docsExamined" : 19179,
	"hasSortStage" : true,
	"cursorExhausted" : true,
	"numYield" : 153,
	"nreturned" : 0,
	"locks" : {
		"Global" : {
			"acquireCount" : {
				"r" : NumberLong(165)
			}
		},
		"Database" : {
			"acquireCount" : {
				"r" : NumberLong(165)
			}
		},
		"Collection" : {
			"acquireCount" : {
				"r" : NumberLong(164)
			}
		}
	},
	"responseLength" : 104,
	"protocol" : "op_msg",
	"millis" : 298,
	"planSummary" : "IXSCAN { _id: 1 }",
	"ts" : ISODate("2019-02-11T07:10:31.936Z"),
	"client" : "127.0.0.1",
	"appName" : "MongoDB Shell",
	"allUsers" : [ ],
	"user" : ""
}
{
	"op" : "command",
	"ns" : "iswcSUBONEk.sub",
	"command" : {
		"aggregate" : "sub",
		"pipeline" : [
			{
				"$match" : {
					"_id" : /^Review/,
					"$comment" : "ISWC_SUB_ONEMil_Query9"
				}
			},
			{
				"$project" : {
					"date" : {
						"$arrayElemAt" : [
							"$Objects",
							{
								"$indexOfArray" : [
									"$Predicates",
									"date"
								]
							}
						]
					},
					"reviewFor" : {
						"$arrayElemAt" : [
							"$Objects",
							{
								"$indexOfArray" : [
									"$Predicates",
									"reviewFor"
								]
							}
						]
					},
					"title" : {
						"$arrayElemAt" : [
							"$Objects",
							{
								"$indexOfArray" : [
									"$Predicates",
									"title"
								]
							}
						]
					},
					"reviewer" : {
						"$arrayElemAt" : [
							"$Objects",
							{
								"$indexOfArray" : [
									"$Predicates",
									"reviewer"
								]
							}
						]
					}
				}
			},
			{
				"$lookup" : {
					"from" : "sub",
					"localField" : "reviewer",
					"foreignField" : "_id",
					"as" : "reviewer"
				}
			},
			{
				"$group" : {
					"_id" : "$reviewer",
					"Reviews" : {
						"$push" : {
							"_id" : "$_id",
							"title" : "$title",
							"product" : "$reviewFor",
							"date" : "$date"
						}
					}
				}
			},
			{
				"$match" : {
					"_id._id" : "Reviewer1089"
				}
			}
		],
		"allowDiskUse" : true,
		"cursor" : {
			
		},
		"lsid" : {
			"id" : UUID("97460ace-5db5-454f-a458-6b26adf283d3")
		},
		"$db" : "iswcSUBONEk"
	},
	"keysExamined" : 19180,
	"docsExamined" : 19179,
	"cursorExhausted" : true,
	"numYield" : 153,
	"nreturned" : 0,
	"locks" : {
		"Global" : {
			"acquireCount" : {
				"r" : NumberLong(38523)
			}
		},
		"Database" : {
			"acquireCount" : {
				"r" : NumberLong(38523)
			}
		},
		"Collection" : {
			"acquireCount" : {
				"r" : NumberLong(38522)
			}
		}
	},
	"responseLength" : 104,
	"protocol" : "op_msg",
	"millis" : 1730,
	"planSummary" : "IXSCAN { _id: 1 }",
	"ts" : ISODate("2019-02-11T07:10:43.468Z"),
	"client" : "127.0.0.1",
	"appName" : "MongoDB Shell",
	"allUsers" : [ ],
	"user" : ""
}
{
	"op" : "command",
	"ns" : "iswcSUBONEk.sub",
	"command" : {
		"aggregate" : "sub",
		"pipeline" : [
			{
				"$match" : {
					"_id" : /^Offer/,
					"$comment" : "ISWC_SUB_ONEMil_Query10"
				}
			},
			{
				"$project" : {
					"deliveryDays" : {
						"$arrayElemAt" : [
							"$Objects",
							{
								"$indexOfArray" : [
									"$Predicates",
									"deliveryDays"
								]
							}
						]
					},
					"vendor" : {
						"$arrayElemAt" : [
							"$Objects",
							{
								"$indexOfArray" : [
									"$Predicates",
									"vendor"
								]
							}
						]
					},
					"date" : {
						"$arrayElemAt" : [
							"$Objects",
							{
								"$indexOfArray" : [
									"$Predicates",
									"date"
								]
							}
						]
					},
					"product" : {
						"$arrayElemAt" : [
							"$Objects",
							{
								"$indexOfArray" : [
									"$Predicates",
									"product"
								]
							}
						]
					},
					"price" : {
						"$arrayElemAt" : [
							"$Objects",
							{
								"$indexOfArray" : [
									"$Predicates",
									"price"
								]
							}
						]
					}
				}
			},
			{
				"$match" : {
					"deliveryDays" : {
						"$lte" : 4
					},
					"product" : "Product1",
					"date" : {
						"$gt" : ISODate("2005-04-03T00:00:00Z")
					}
				}
			},
			{
				"$lookup" : {
					"from" : "sub",
					"localField" : "vendor",
					"foreignField" : "_id",
					"as" : "vendor"
				}
			},
			{
				"$match" : {
					"vendor.Objects" : "US"
				}
			},
			{
				"$sort" : {
					"price" : 1
				}
			},
			{
				"$limit" : 10
			}
		],
		"allowDiskUse" : true,
		"cursor" : {
			
		},
		"lsid" : {
			"id" : UUID("97460ace-5db5-454f-a458-6b26adf283d3")
		},
		"$db" : "iswcSUBONEk"
	},
	"keysExamined" : 36501,
	"docsExamined" : 36500,
	"hasSortStage" : true,
	"cursorExhausted" : true,
	"numYield" : 287,
	"nreturned" : 1,
	"locks" : {
		"Global" : {
			"acquireCount" : {
				"r" : NumberLong(303)
			}
		},
		"Database" : {
			"acquireCount" : {
				"r" : NumberLong(303)
			}
		},
		"Collection" : {
			"acquireCount" : {
				"r" : NumberLong(302)
			}
		}
	},
	"responseLength" : 710,
	"protocol" : "op_msg",
	"millis" : 504,
	"planSummary" : "IXSCAN { _id: 1 }",
	"ts" : ISODate("2019-02-11T07:10:51.711Z"),
	"client" : "127.0.0.1",
	"appName" : "MongoDB Shell",
	"allUsers" : [ ],
	"user" : ""
}
{
	"op" : "command",
	"ns" : "iswcSUBONEk.sub",
	"command" : {
		"aggregate" : "sub",
		"pipeline" : [
			{
				"$match" : {
					"_id" : "Offer1",
					"$comment" : "ISWC_SUB_ONEMil_Query11"
				}
			},
			{
				"$project" : {
					"Predicates" : "$Predicates",
					"Objects" : "$Objects",
					"product" : {
						"$arrayElemAt" : [
							"$Objects",
							{
								"$indexOfArray" : [
									"$Predicates",
									"product"
								]
							}
						]
					}
				}
			},
			{
				"$lookup" : {
					"from" : "sub",
					"localField" : "product",
					"foreignField" : "_id",
					"as" : "product"
				}
			}
		],
		"allowDiskUse" : true,
		"cursor" : {
			
		},
		"lsid" : {
			"id" : UUID("97460ace-5db5-454f-a458-6b26adf283d3")
		},
		"$db" : "iswcSUBONEk"
	},
	"keysExamined" : 1,
	"docsExamined" : 1,
	"cursorExhausted" : true,
	"numYield" : 0,
	"nreturned" : 1,
	"locks" : {
		"Global" : {
			"acquireCount" : {
				"r" : NumberLong(5)
			}
		},
		"Database" : {
			"acquireCount" : {
				"r" : NumberLong(5)
			}
		},
		"Collection" : {
			"acquireCount" : {
				"r" : NumberLong(4)
			}
		}
	},
	"responseLength" : 2850,
	"protocol" : "op_msg",
	"millis" : 2,
	"planSummary" : "IXSCAN { _id: 1 }",
	"ts" : ISODate("2019-02-11T07:10:59.283Z"),
	"client" : "127.0.0.1",
	"appName" : "MongoDB Shell",
	"allUsers" : [ ],
	"user" : ""
}
> 






























